<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>GlobalQuake LiveCam - åœ°éœ‡é€Ÿå ±é€£å‹•ãƒ©ã‚¤ãƒ–ã‚«ãƒ¡ãƒ©</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #1a1a2e 0%, #16213e 50%, #0f3460 100%);
            color: #ffffff;
            min-height: 100vh;
            overflow-x: hidden;
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
            padding: 20px;
        }

        .header {
            text-align: center;
            margin-bottom: 30px;
            padding: 20px;
            background: rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(10px);
            border-radius: 20px;
            border: 1px solid rgba(255, 255, 255, 0.2);
        }

        .header h1 {
            font-size: 2.5rem;
            margin-bottom: 10px;
            background: linear-gradient(45deg, #ff6b6b, #feca57, #48dbfb);
            background-clip: text;
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            text-shadow: 0 0 30px rgba(255, 107, 107, 0.3);
        }

        .header p {
            color: #b0b0b0;
            font-size: 1.1rem;
        }

        .status-bar {
            display: flex;
            justify-content: space-between;
            align-items: center;
            background: rgba(0, 0, 0, 0.3);
            padding: 15px 20px;
            border-radius: 15px;
            margin-bottom: 20px;
            flex-wrap: wrap;
            gap: 15px;
        }

        .status-item {
            display: flex;
            align-items: center;
            gap: 8px;
            font-size: 0.9rem;
        }

        .status-indicator {
            width: 12px;
            height: 12px;
            border-radius: 50%;
            background: #4ade80;
            animation: pulse 2s infinite;
        }

        .status-indicator.warning {
            background: #fbbf24;
        }

        .status-indicator.error {
            background: #ef4444;
        }

        @keyframes pulse {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.5; }
        }

        .main-content {
            display: grid;
            grid-template-columns: 1fr 350px;
            gap: 20px;
            margin-bottom: 20px;
        }

        .video-section {
            background: rgba(255, 255, 255, 0.05);
            padding: 25px;
            border-radius: 20px;
            border: 1px solid rgba(255, 255, 255, 0.1);
            position: relative;
        }

        .video-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 15px;
        }

        .video-title {
            font-size: 1.3rem;
            font-weight: 600;
        }

        .video-controls {
            display: flex;
            gap: 10px;
        }

        .btn {
            background: rgba(255, 255, 255, 0.1);
            border: 1px solid rgba(255, 255, 255, 0.2);
            color: white;
            padding: 8px 12px;
            border-radius: 8px;
            cursor: pointer;
            font-size: 0.9rem;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            gap: 5px;
        }

        .btn:hover {
            background: rgba(255, 255, 255, 0.2);
            transform: translateY(-2px);
        }

        .btn.primary {
            background: linear-gradient(45deg, #667eea, #764ba2);
        }

        .btn.primary:hover {
            background: linear-gradient(45deg, #764ba2, #667eea);
        }

        .video-container {
            position: relative;
            width: 100%;
            height: 500px;
            background: #000;
            border-radius: 10px;
            overflow: hidden;
            border: 2px solid rgba(255, 255, 255, 0.1);
        }

        .video-iframe {
            width: 100%;
            height: 100%;
            border: none;
        }

        .loading-overlay {
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0, 0, 0, 0.8);
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            z-index: 10;
        }

        .loading-spinner {
            width: 50px;
            height: 50px;
            border: 3px solid rgba(255, 255, 255, 0.3);
            border-top: 3px solid #667eea;
            border-radius: 50%;
            animation: spin 1s linear infinite;
            margin-bottom: 15px;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        .sidebar {
            display: flex;
            flex-direction: column;
            gap: 20px;
        }

        .panel {
            background: rgba(255, 255, 255, 0.05);
            padding: 20px;
            border-radius: 15px;
            border: 1px solid rgba(255, 255, 255, 0.1);
        }

        .panel-header {
            display: flex;
            align-items: center;
            gap: 10px;
            margin-bottom: 15px;
            font-weight: 600;
            font-size: 1.1rem;
        }

        .settings-grid {
            display: grid;
            gap: 15px;
        }

        .form-group {
            display: flex;
            flex-direction: column;
            gap: 5px;
        }

        .form-label {
            font-size: 0.9rem;
            color: #b0b0b0;
            font-weight: 500;
        }

        .form-input {
            background: rgba(255, 255, 255, 0.1);
            border: 1px solid rgba(255, 255, 255, 0.2);
            color: white;
            padding: 10px 12px;
            border-radius: 8px;
            font-size: 0.9rem;
            transition: all 0.3s ease;
        }

        .form-input:focus {
            outline: none;
            border-color: #667eea;
            box-shadow: 0 0 0 3px rgba(102, 126, 234, 0.1);
        }

        .form-select {
            background: rgba(255, 255, 255, 0.1);
            border: 1px solid rgba(255, 255, 255, 0.2);
            color: white;
            padding: 10px 12px;
            border-radius: 8px;
            font-size: 0.9rem;
        }

        .earthquake-alert {
            background: linear-gradient(45deg, #ff4757, #ff3838);
            padding: 15px;
            border-radius: 10px;
            margin-bottom: 15px;
            animation: alertPulse 1s infinite;
            display: none;
        }

        .earthquake-alert.active {
            display: block;
        }

        @keyframes alertPulse {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.8; }
        }

        .history-item {
            background: rgba(255, 255, 255, 0.05);
            padding: 12px;
            border-radius: 8px;
            margin-bottom: 8px;
            border-left: 3px solid #667eea;
        }

        .history-time {
            font-size: 0.8rem;
            color: #888;
            margin-bottom: 4px;
        }

        .history-info {
            font-size: 0.9rem;
        }

        .preset-buttons {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 10px;
            margin-bottom: 15px;
        }

        .preset-btn {
            background: rgba(255, 255, 255, 0.1);
            border: 1px solid rgba(255, 255, 255, 0.2);
            color: white;
            padding: 8px 12px;
            border-radius: 6px;
            cursor: pointer;
            font-size: 0.8rem;
            transition: all 0.3s ease;
        }

        .preset-btn:hover {
            background: rgba(255, 255, 255, 0.2);
        }

        .fullscreen-btn {
            position: absolute;
            top: 15px;
            right: 15px;
            background: rgba(0, 0, 0, 0.7);
            border: none;
            color: white;
            padding: 8px;
            border-radius: 50%;
            cursor: pointer;
            transition: all 0.3s ease;
            z-index: 5;
        }

        .fullscreen-btn:hover {
            background: rgba(0, 0, 0, 0.9);
            transform: scale(1.1);
        }

        .alert-settings {
            background: rgba(255, 193, 7, 0.1);
            border: 1px solid rgba(255, 193, 7, 0.3);
            padding: 15px;
            border-radius: 10px;
            margin-top: 15px;
        }

        .toggle-switch {
            position: relative;
            display: inline-block;
            width: 50px;
            height: 24px;
        }

        .toggle-switch input {
            opacity: 0;
            width: 0;
            height: 0;
        }

        .slider {
            position: absolute;
            cursor: pointer;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background-color: rgba(255, 255, 255, 0.2);
            transition: .4s;
            border-radius: 24px;
        }

        .slider:before {
            position: absolute;
            content: "";
            height: 18px;
            width: 18px;
            left: 3px;
            bottom: 3px;
            background-color: white;
            transition: .4s;
            border-radius: 50%;
        }

        input:checked + .slider {
            background-color: #667eea;
        }

        input:checked + .slider:before {
            transform: translateX(26px);
        }

        @media (max-width: 768px) {
            .main-content {
                grid-template-columns: 1fr;
            }
            
            .header h1 {
                font-size: 2rem;
            }
            
            .status-bar {
                flex-direction: column;
                align-items: stretch;
            }
            
            .video-container {
                height: 300px;
            }
            
            .container {
                padding: 10px;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <header class="header">
            <h1><i class="fas fa-globe-asia"></i> GlobalQuake LiveCam</h1>
            <p>åœ°éœ‡é€Ÿå ±é€£å‹•ãƒ©ã‚¤ãƒ–ã‚«ãƒ¡ãƒ©ã‚·ã‚¹ãƒ†ãƒ </p>
        </header>

        <div class="status-bar">
            <div class="status-item">
                <div class="status-indicator" id="connectionStatus"></div>
                <span>æ¥ç¶šçŠ¶æ…‹: <span id="connectionText">æ¥ç¶šä¸­</span></span>
            </div>
            <div class="status-item">
                <i class="fas fa-clock"></i>
                <span>æœ€çµ‚æ›´æ–°: <span id="lastUpdate">--:--</span></span>
            </div>
            <div class="status-item">
                <i class="fas fa-video"></i>
                <span>ã‚«ãƒ¡ãƒ©: <span id="cameraStatus">æ­£å¸¸</span></span>
            </div>
            <div class="status-item">
                <i class="fas fa-exclamation-triangle"></i>
                <span>åœ°éœ‡æƒ…å ±: <span id="earthquakeStatus">ç›£è¦–ä¸­</span></span>
            </div>
        </div>

        <div class="earthquake-alert" id="earthquakeAlert">
            <i class="fas fa-exclamation-triangle"></i>
            <strong>ç·Šæ€¥åœ°éœ‡é€Ÿå ±</strong>
            <div id="alertContent"></div>
        </div>

        <div class="main-content">
            <section class="video-section">
                <div class="video-header">
                    <h2 class="video-title"><i class="fas fa-video"></i> ãƒ©ã‚¤ãƒ–ã‚«ãƒ¡ãƒ©æ˜ åƒ</h2>
                    <div class="video-controls">
                        <button class="btn" onclick="refreshVideo()">
                            <i class="fas fa-sync-alt"></i> æ›´æ–°
                        </button>
                        <button class="btn" onclick="toggleFullscreen()">
                            <i class="fas fa-expand"></i> å…¨ç”»é¢
                        </button>
                    </div>
                </div>
                <div class="video-container" id="videoContainer">
                    <button class="fullscreen-btn" onclick="toggleFullscreen()">
                        <i class="fas fa-expand"></i>
                    </button>
                    <iframe 
                        class="video-iframe" 
                        id="videoIframe"
                        src="about:blank"
                        title="ãƒ©ã‚¤ãƒ–ã‚«ãƒ¡ãƒ©æ˜ åƒ">
                    </iframe>
                    <div class="loading-overlay" id="loadingOverlay">
                        <div class="loading-spinner"></div>
                        <p>æ˜ åƒã‚’èª­ã¿è¾¼ã¿ä¸­...</p>
                    </div>
                </div>
            </section>

            <aside class="sidebar">
                <div class="panel">
                    <div class="panel-header">
                        <i class="fas fa-cog"></i>
                        <span>è¨­å®š</span>
                    </div>
                    
                    <div class="preset-buttons">
                        <button class="preset-btn" onclick="applyPreset('default')">æ¨™æº–è¨­å®š</button>
                        <button class="preset-btn" onclick="applyPreset('monitoring')">ç›£è¦–ãƒ¢ãƒ¼ãƒ‰</button>
                        <button class="preset-btn" onclick="applyPreset('mobile')">ãƒ¢ãƒã‚¤ãƒ«æœ€é©åŒ–</button>
                        <button class="preset-btn" onclick="applyPreset('lowBandwidth')">ä½å¸¯åŸŸ</button>
                    </div>

                    <div class="settings-grid">
                        <div class="form-group">
                            <label class="form-label">ã‚«ãƒ¡ãƒ©ã‚½ãƒ¼ã‚¹</label>
                            <select class="form-select" id="cameraSource">
                                <option value="">ã‚«ãƒ¡ãƒ©ã‚’é¸æŠ...</option>
                                <option value="https://www.youtube.com/embed/dQw4w9WgXcQ">Sample Camera 1</option>
                                <option value="https://www.youtube.com/embed/jNQXAC9IVRw">Sample Camera 2</option>
                            </select>
                        </div>

                        <div class="form-group">
                            <label class="form-label">æ›´æ–°é–“éš” (åˆ†)</label>
                            <input type="number" class="form-input" id="updateInterval" value="5" min="1" max="60">
                        </div>

                        <div class="form-group">
                            <label class="form-label">å±¥æ­´ä¿å­˜ä»¶æ•°</label>
                            <input type="number" class="form-input" id="historyCount" value="10" min="5" max="50">
                        </div>

                        <div class="form-group">
                            <label class="form-label">æ˜ åƒã‚µã‚¤ã‚º</label>
                            <select class="form-select" id="videoSize">
                                <option value="auto">è‡ªå‹•èª¿æ•´</option>
                                <option value="720p">720p (1280x720)</option>
                                <option value="480p">480p (854x480)</option>
                                <option value="360p">360p (640x360)</option>
                            </select>
                        </div>

                        <button class="btn primary" onclick="applySettings()">
                            <i class="fas fa-check"></i> è¨­å®šã‚’é©ç”¨
                        </button>
                    </div>

                    <div class="alert-settings">
                        <div class="form-group">
                            <label class="form-label">
                                <i class="fas fa-bell"></i> ç·Šæ€¥åœ°éœ‡é€Ÿå ±ã‚¢ãƒ©ãƒ¼ãƒˆ
                            </label>
                            <label class="toggle-switch">
                                <input type="checkbox" id="alertEnabled" checked>
                                <span class="slider"></span>
                            </label>
                        </div>
                    </div>
                </div>

                <div class="panel">
                    <div class="panel-header">
                        <i class="fas fa-history"></i>
                        <span>åœ°éœ‡å±¥æ­´</span>
                    </div>
                    <div id="earthquakeHistory">
                        <div class="history-item">
                            <div class="history-time">2024-01-15 14:30</div>
                            <div class="history-info">éœ‡åº¦3 - æ±äº¬éƒ½23åŒº (M4.2)</div>
                        </div>
                        <div class="history-item">
                            <div class="history-time">2024-01-14 09:15</div>
                            <div class="history-info">éœ‡åº¦2 - ç¥å¥ˆå·çœŒæ±éƒ¨ (M3.8)</div>
                        </div>
                        <div class="history-item">
                            <div class="history-time">2024-01-13 22:45</div>
                            <div class="history-info">éœ‡åº¦1 - åƒè‘‰çœŒåŒ—è¥¿éƒ¨ (M3.1)</div>
                        </div>
                    </div>
                </div>

                <div class="panel">
                    <div class="panel-header">
                        <i class="fas fa-info-circle"></i>
                        <span>ã‚·ã‚¹ãƒ†ãƒ æƒ…å ±</span>
                    </div>
                    <div class="status-item" style="justify-content: space-between; margin-bottom: 10px;">
                        <span>ãƒãƒ¼ã‚¸ãƒ§ãƒ³:</span>
                        <span>v2.1.0</span>
                    </div>
                    <div class="status-item" style="justify-content: space-between; margin-bottom: 10px;">
                        <span>ç¨¼åƒæ™‚é–“:</span>
                        <span id="uptime">--:--:--</span>
                    </div>
                    <div class="status-item" style="justify-content: space-between;">
                        <span>ãƒ‡ãƒ¼ã‚¿ã‚½ãƒ¼ã‚¹:</span>
                        <span>æ°—è±¡åºAPI</span>
                    </div>
                </div>
            </aside>
        </div>
    </div>

    <script>
        // ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³çŠ¶æ…‹ç®¡ç†
        const AppState = {
            settings: {
                updateInterval: 5,
                historyCount: 10,
                cameraSource: '',
                videoSize: 'auto',
                alertEnabled: true
            },
            isFullscreen: false,
            startTime: Date.now(),
            earthquakeData: []
        };

        // åˆæœŸåŒ–
        document.addEventListener('DOMContentLoaded', function() {
            initializeApp();
            startStatusUpdates();
            loadSettings();
        });

        function initializeApp() {
            console.log('GlobalQuake LiveCam ã‚·ã‚¹ãƒ†ãƒ ã‚’åˆæœŸåŒ–ä¸­...');
            updateConnectionStatus('connected');
            updateLastUpdateTime();
            hideLoadingOverlay();
        }

        function startStatusUpdates() {
            // å®šæœŸçš„ãªçŠ¶æ…‹æ›´æ–°
            setInterval(() => {
                updateLastUpdateTime();
                updateUptime();
                simulateEarthquakeData();
            }, 30000); // 30ç§’é–“éš”

            // ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ æ›´æ–°
            setInterval(() => {
                updateUptime();
            }, 1000);
        }

        function updateConnectionStatus(status) {
            const indicator = document.getElementById('connectionStatus');
            const text = document.getElementById('connectionText');
            
            switch(status) {
                case 'connected':
                    indicator.className = 'status-indicator';
                    text.textContent = 'æ¥ç¶šæ¸ˆã¿';
                    break;
                case 'connecting':
                    indicator.className = 'status-indicator warning';
                    text.textContent = 'æ¥ç¶šä¸­';
                    break;
                case 'error':
                    indicator.className = 'status-indicator error';
                    text.textContent = 'æ¥ç¶šã‚¨ãƒ©ãƒ¼';
                    break;
            }
        }

        function updateLastUpdateTime() {
            const now = new Date();
            const timeString = now.toLocaleTimeString('ja-JP', { 
                hour: '2-digit', 
                minute: '2-digit' 
            });
            document.getElementById('lastUpdate').textContent = timeString;
        }

        function updateUptime() {
            const uptime = Date.now() - AppState.startTime;
            const hours = Math.floor(uptime / (1000 * 60 * 60));
            const minutes = Math.floor((uptime % (1000 * 60 * 60)) / (1000 * 60));
            const seconds = Math.floor((uptime % (1000 * 60)) / 1000);
            
            document.getElementById('uptime').textContent = 
                `${hours.toString().padStart(2, '0')}:${minutes.toString().padStart(2, '0')}:${seconds.toString().padStart(2, '0')}`;
        }

        function applySettings() {
            const settings = {
                updateInterval: parseInt(document.getElementById('updateInterval').value),
                historyCount: parseInt(document.getElementById('historyCount').value),
                cameraSource: document.getElementById('cameraSource').value,
                videoSize: document.getElementById('videoSize').value,
                alertEnabled: document.getElementById('alertEnabled').checked
            };

            AppState.settings = { ...AppState.settings, ...settings };
            
            // ã‚«ãƒ¡ãƒ©ã‚½ãƒ¼ã‚¹ã®æ›´æ–°
            if (settings.cameraSource) {
                updateVideoSource(settings.cameraSource);
            }

            // è¨­å®šã®ä¿å­˜ï¼ˆå®Ÿéš›ã®å®Ÿè£…ã§ã¯localStorageã®ä»£ã‚ã‚Šã«ãƒ¡ãƒ¢ãƒªã«ä¿å­˜ï¼‰
            console.log('è¨­å®šã‚’é©ç”¨ã—ã¾ã—ãŸ:', settings);
            
            // ãƒ¦ãƒ¼ã‚¶ãƒ¼ãƒ•ã‚£ãƒ¼ãƒ‰ãƒãƒƒã‚¯
            showNotification('è¨­å®šãŒé©ç”¨ã•ã‚Œã¾ã—ãŸ', 'success');
        }

        function applyPreset(presetName) {
            const presets = {
                default: {
                    updateInterval: 5,
                    historyCount: 10,
                    videoSize: 'auto'
                },
                monitoring: {
                    updateInterval: 1,
                    historyCount: 50,
                    videoSize: '720p'
                },
                mobile: {
                    updateInterval: 10,
                    historyCount: 5,
                    videoSize: '360p'
                },
                lowBandwidth: {
                    updateInterval: 15,
                    historyCount: 5,
                    videoSize: '360p'
                }
            };

            const preset = presets[presetName];
            if (preset) {
                document.getElementById('updateInterval').value = preset.updateInterval;
                document.getElementById('historyCount').value = preset.historyCount;
                document.getElementById('videoSize').value = preset.videoSize;
                
                showNotification(`${presetName}è¨­å®šã‚’é©ç”¨ã—ã¾ã—ãŸ`, 'info');
            }
        }

        function updateVideoSource(src) {
            const iframe = document.getElementById('videoIframe');
            const overlay = document.getElementById('loadingOverlay');
            
            showLoadingOverlay();
            
            iframe.src = src;
            
            iframe.onload = function() {
                setTimeout(() => {
                    hideLoadingOverlay();
                }, 1000);
            };
        }

        function refreshVideo() {
            const iframe = document.getElementById('videoIframe');
            const currentSrc = iframe.src;
            
            if (currentSrc && currentSrc !== 'about:blank') {
                showLoadingOverlay();
                iframe.src = '';
                setTimeout(() => {
                    iframe.src = currentSrc;
                }, 100);
                
                showNotification('æ˜ åƒã‚’æ›´æ–°ã—ã¦ã„ã¾ã™', 'info');
            } else {
                showNotification('ã‚«ãƒ¡ãƒ©ã‚½ãƒ¼ã‚¹ã‚’é¸æŠã—ã¦ãã ã•ã„', 'warning');
            }
        }

        function toggleFullscreen() {
            const container = document.getElementById('videoContainer');
            
            if (!AppState.isFullscreen) {
                if (container.requestFullscreen) {
                    container.requestFullscreen();
                } else if (container.webkitRequestFullscreen) {
                    container.webkitRequestFullscreen();
                } else if (container.msRequestFullscreen) {
                    container.msRequestFullscreen();
                }
                AppState.isFullscreen = true;
            } else {
                if (document.exitFullscreen) {
                    document.exitFullscreen();
                } else if (document.webkitExitFullscreen) {
                    document.webkitExitFullscreen();
                } else if (document.msExitFullscreen) {
                    document.msExitFullscreen();
                }
                AppState.isFullscreen = false;
            }
        }

        function showLoadingOverlay() {
            document.getElementById('loadingOverlay').style.display = 'flex';
        }

        function hideLoadingOverlay() {
            document.getElementById('loadingOverlay').style.display = 'none';
        }

        function simulateEarthquakeData() {
            // åœ°éœ‡ãƒ‡ãƒ¼ã‚¿ã®ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ï¼ˆå®Ÿéš›ã®å®Ÿè£…ã§ã¯æ°—è±¡åºAPIã‚’ä½¿ç”¨ï¼‰
            const earthquakeStatus = document.getElementById('earthquakeStatus');
            const randomCheck = Math.random();
            
            if (randomCheck < 0.1) { // 10%ã®ç¢ºç‡ã§åœ°éœ‡ç™ºç”Ÿã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³
                const magnitude = (Math.random() * 3 + 2).toFixed(1);
                const intensity = Math.floor(Math.random() * 4 + 1);
                const locations = ['æ±äº¬éƒ½23åŒº', 'ç¥å¥ˆå·çœŒæ±éƒ¨', 'åƒè‘‰çœŒåŒ—è¥¿éƒ¨', 'åŸ¼ç‰çœŒå—éƒ¨'];
                const location = locations[Math.floor(Math.random() * locations.length)];
                
                earthquakeStatus.textContent = `éœ‡åº¦${intensity}æ¤œå‡º`;
                
                if (AppState.settings.alertEnabled && intensity >= 3) {
                    showEarthquakeAlert(`éœ‡åº¦${intensity} - ${location} (M${magnitude})`);
                }
                
                addEarthquakeHistory(`éœ‡åº¦${intensity} - ${location} (M${magnitude})`);
            } else {
                earthquakeStatus.textContent = 'ç›£è¦–ä¸­';
            }
        }

        function showEarthquakeAlert(message) {
            const alert = document.getElementById('earthquakeAlert');
            const content = document.getElementById('alertContent');
            
            content.textContent = message;
            alert.classList.add('active');
            
            // è‡ªå‹•çš„ã«ã‚¢ãƒ©ãƒ¼ãƒˆã‚’éè¡¨ç¤ºã«ã™ã‚‹
            setTimeout(() => {
                alert.classList.remove('active');
            }, 10000);
        }

        function addEarthquakeHistory(info) {
            const historyContainer = document.getElementById('earthquakeHistory');
            const now = new Date();
            const timeString = now.toLocaleDateString('ja-JP') + ' ' + 
                             now.toLocaleTimeString('ja-JP', { 
                                 hour: '2-digit', 
                                 minute: '2-digit' 
                             });
            
            const historyItem = document.createElement('div');
            historyItem.className = 'history-item';
            historyItem.innerHTML = `
                <div class="history-time">${timeString}</div>
                <div class="history-info">${info}</div>
            `;
            
            historyContainer.insertBefore(historyItem, historyContainer.firstChild);
            
            // å±¥æ­´ä»¶æ•°åˆ¶é™
            const items = historyContainer.querySelectorAll('.history-item');
            if (items.length > AppState.settings.historyCount) {
                items[items.length - 1].remove();
            }
        }

        function showNotification(message, type = 'info') {
            // ç°¡æ˜“é€šçŸ¥ã‚·ã‚¹ãƒ†ãƒ ï¼ˆå®Ÿéš›ã®å®Ÿè£…ã§ã¯ã‚ˆã‚Šè©³ç´°ãªé€šçŸ¥UIã‚’ä½œæˆï¼‰
            console.log(`[${type.toUpperCase()}] ${message}`);
            
            // ã“ã“ã§Toasté€šçŸ¥ãªã©ã‚’è¡¨ç¤ºã™ã‚‹ã“ã¨ãŒã§ãã‚‹
            const notification = document.createElement('div');
            notification.style.cssText = `
                position: fixed;
                top: 20px;
                right: 20px;
                background: rgba(0, 0, 0, 0.9);
                color: white;
                padding: 15px 20px;
                border-radius: 8px;
                z-index: 1000;
                font-size: 0.9rem;
                max-width: 300px;
                border-left: 4px solid ${type === 'success' ? '#4ade80' : type === 'warning' ? '#fbbf24' : '#667eea'};
            `;
            
            notification.textContent = message;
            document.body.appendChild(notification);
            
            // ã‚¢ãƒ‹ãƒ¡ãƒ¼ã‚·ãƒ§ãƒ³åŠ¹æœ
            notification.style.transform = 'translateX(100%)';
            notification.style.transition = 'transform 0.3s ease';
            
            setTimeout(() => {
                notification.style.transform = 'translateX(0)';
            }, 10);
            
            // è‡ªå‹•å‰Šé™¤
            setTimeout(() => {
                notification.style.transform = 'translateX(100%)';
                setTimeout(() => {
                    if (notification.parentNode) {
                        notification.parentNode.removeChild(notification);
                    }
                }, 300);
            }, 3000);
        }

        function loadSettings() {
            // åˆæœŸè¨­å®šã®èª­ã¿è¾¼ã¿ï¼ˆå®Ÿéš›ã®å®Ÿè£…ã§ã¯ä¿å­˜ã•ã‚ŒãŸè¨­å®šã‚’å¾©å…ƒï¼‰
            document.getElementById('updateInterval').value = AppState.settings.updateInterval;
            document.getElementById('historyCount').value = AppState.settings.historyCount;
            document.getElementById('alertEnabled').checked = AppState.settings.alertEnabled;
        }

        // ãƒ•ãƒ«ã‚¹ã‚¯ãƒªãƒ¼ãƒ³çŠ¶æ…‹ã®å¤‰æ›´ã‚’ç›£è¦–
        document.addEventListener('fullscreenchange', function() {
            AppState.isFullscreen = !!document.fullscreenElement;
        });

        document.addEventListener('webkitfullscreenchange', function() {
            AppState.isFullscreen = !!document.webkitFullscreenElement;
        });

        // ã‚­ãƒ¼ãƒœãƒ¼ãƒ‰ã‚·ãƒ§ãƒ¼ãƒˆã‚«ãƒƒãƒˆ
        document.addEventListener('keydown', function(e) {
            if (e.ctrlKey || e.metaKey) {
                switch(e.key) {
                    case 'r':
                        e.preventDefault();
                        refreshVideo();
                        break;
                    case 'f':
                        e.preventDefault();
                        toggleFullscreen();
                        break;
                    case 's':
                        e.preventDefault();
                        applySettings();
                        break;
                }
            }
            
            // ESCã‚­ãƒ¼ã§ã‚¢ãƒ©ãƒ¼ãƒˆã‚’é–‰ã˜ã‚‹
            if (e.key === 'Escape') {
                const alert = document.getElementById('earthquakeAlert');
                if (alert.classList.contains('active')) {
                    alert.classList.remove('active');
                }
            }
        });

        // ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°
        window.addEventListener('error', function(e) {
            console.error('ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã‚¨ãƒ©ãƒ¼:', e.error);
            showNotification('ã‚·ã‚¹ãƒ†ãƒ ã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã—ã¾ã—ãŸ', 'error');
            updateConnectionStatus('error');
        });

        // ã‚ªãƒ³ãƒ©ã‚¤ãƒ³/ã‚ªãƒ•ãƒ©ã‚¤ãƒ³çŠ¶æ…‹ã®ç›£è¦–
        window.addEventListener('online', function() {
            updateConnectionStatus('connected');
            showNotification('ã‚¤ãƒ³ã‚¿ãƒ¼ãƒãƒƒãƒˆæ¥ç¶šãŒå¾©æ—§ã—ã¾ã—ãŸ', 'success');
        });

        window.addEventListener('offline', function() {
            updateConnectionStatus('error');
            showNotification('ã‚¤ãƒ³ã‚¿ãƒ¼ãƒãƒƒãƒˆæ¥ç¶šãŒåˆ‡æ–­ã•ã‚Œã¾ã—ãŸ', 'error');
        });

        // ãƒšãƒ¼ã‚¸é›¢è„±å‰ã®ç¢ºèªï¼ˆè¨­å®šå¤‰æ›´ãŒã‚ã‚‹å ´åˆï¼‰
        window.addEventListener('beforeunload', function(e) {
            // å®Ÿéš›ã®å®Ÿè£…ã§ã¯æœªä¿å­˜ã®å¤‰æ›´ãŒã‚ã‚‹ã‹ãƒã‚§ãƒƒã‚¯
            // e.preventDefault();
            // e.returnValue = '';
        });

        // ã‚¢ã‚¯ã‚»ã‚·ãƒ“ãƒªãƒ†ã‚£: ãƒ•ã‚©ãƒ¼ã‚«ã‚¹ç®¡ç†
        document.addEventListener('keydown', function(e) {
            if (e.key === 'Tab') {
                // Tab ã‚­ãƒ¼ã§ã®ãƒ•ã‚©ãƒ¼ã‚«ã‚¹ç§»å‹•æ™‚ã«è¦–è¦šçš„ãªã‚¤ãƒ³ã‚¸ã‚±ãƒ¼ã‚¿ãƒ¼ã‚’è¡¨ç¤º
                document.body.classList.add('keyboard-navigation');
            }
        });

        document.addEventListener('mousedown', function() {
            document.body.classList.remove('keyboard-navigation');
        });

        // ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹ç›£è¦–
        if ('performance' in window && 'getEntriesByType' in performance) {
            setTimeout(() => {
                const navigationTiming = performance.getEntriesByType('navigation')[0];
                if (navigationTiming) {
                    const loadTime = navigationTiming.loadEventEnd - navigationTiming.loadEventStart;
                    console.log(`ãƒšãƒ¼ã‚¸èª­ã¿è¾¼ã¿æ™‚é–“: ${loadTime}ms`);
                }
            }, 1000);
        }

        // Service Workerç™»éŒ²ï¼ˆPWAåŒ–ã®æº–å‚™ï¼‰
        if ('serviceWorker' in navigator) {
            window.addEventListener('load', function() {
                // å®Ÿéš›ã®å®Ÿè£…ã§ã¯Service Workerã‚’ç™»éŒ²
                console.log('Service Workerå¯¾å¿œãƒ–ãƒ©ã‚¦ã‚¶ã§ã™');
            });
        }

        // å®šæœŸçš„ãªãƒ˜ãƒ«ã‚¹ãƒã‚§ãƒƒã‚¯
        setInterval(() => {
            // ã‚·ã‚¹ãƒ†ãƒ ã®å¥åº·çŠ¶æ…‹ã‚’ãƒã‚§ãƒƒã‚¯
            checkSystemHealth();
        }, 60000); // 1åˆ†é–“éš”

        function checkSystemHealth() {
            const memoryInfo = performance.memory;
            if (memoryInfo) {
                const used = memoryInfo.usedJSHeapSize;
                const total = memoryInfo.totalJSHeapSize;
                const limit = memoryInfo.jsHeapSizeLimit;
                
                // ãƒ¡ãƒ¢ãƒªä½¿ç”¨é‡ãŒ90%ã‚’è¶…ãˆãŸå ´åˆã®è­¦å‘Š
                if (used / limit > 0.9) {
                    console.warn('ãƒ¡ãƒ¢ãƒªä½¿ç”¨é‡ãŒé«˜ããªã£ã¦ã„ã¾ã™');
                    showNotification('ã‚·ã‚¹ãƒ†ãƒ ãƒªã‚½ãƒ¼ã‚¹ã®ä½¿ç”¨é‡ãŒé«˜ããªã£ã¦ã„ã¾ã™', 'warning');
                }
            }
        }

        // ç”»é¢ã‚µã‚¤ã‚ºå¤‰æ›´æ™‚ã®ãƒ¬ã‚¹ãƒãƒ³ã‚·ãƒ–å¯¾å¿œ
        window.addEventListener('resize', function() {
            // ãƒ“ãƒ¥ãƒ¼ãƒãƒ¼ãƒˆã‚µã‚¤ã‚ºã«å¿œã˜ãŸèª¿æ•´
            const isMobile = window.innerWidth <= 768;
            const videoContainer = document.getElementById('videoContainer');
            
            if (isMobile) {
                videoContainer.style.height = '250px';
            } else {
                videoContainer.style.height = '500px';
            }
        });

        // åˆæœŸè¡¨ç¤ºæ™‚ã«ã‚¦ã‚§ãƒ«ã‚«ãƒ ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸
        setTimeout(() => {
            if (!sessionStorage.getItem('welcomed')) {
                showNotification('GlobalQuake LiveCamã¸ã‚ˆã†ã“ãï¼', 'info');
                // ã‚»ãƒƒã‚·ãƒ§ãƒ³ã‚¹ãƒˆãƒ¬ãƒ¼ã‚¸ã®ä»£ã‚ã‚Šã«å¤‰æ•°ã§ç®¡ç†
                window.welcomeShown = true;
            }
        }, 2000);

        // ãƒ‡ãƒãƒƒã‚°ç”¨ã®é–‹ç™ºè€…ã‚³ãƒ³ã‚½ãƒ¼ãƒ«æƒ…å ±
        console.log(`
        ğŸŒ GlobalQuake LiveCam v2.1.0
        ================================
        
        ã‚­ãƒ¼ãƒœãƒ¼ãƒ‰ã‚·ãƒ§ãƒ¼ãƒˆã‚«ãƒƒãƒˆ:
        â€¢ Ctrl+R: æ˜ åƒæ›´æ–°
        â€¢ Ctrl+F: å…¨ç”»é¢åˆ‡ã‚Šæ›¿ãˆ
        â€¢ Ctrl+S: è¨­å®šé©ç”¨
        â€¢ ESC: ã‚¢ãƒ©ãƒ¼ãƒˆé–‰ã˜ã‚‹
        
        ã‚·ã‚¹ãƒ†ãƒ æƒ…å ±:
        â€¢ ãƒ–ãƒ©ã‚¦ã‚¶: ${navigator.userAgent}
        â€¢ ç”»é¢è§£åƒåº¦: ${window.screen.width}x${window.screen.height}
        â€¢ ã‚¿ã‚¤ãƒ ã‚¾ãƒ¼ãƒ³: ${Intl.DateTimeFormat().resolvedOptions().timeZone}
        
        é–‹ç™ºè€…å‘ã‘æ©Ÿèƒ½:
        â€¢ AppState: ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³çŠ¶æ…‹
        â€¢ simulateEarthquakeData(): åœ°éœ‡ãƒ‡ãƒ¼ã‚¿ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³
        â€¢ checkSystemHealth(): ã‚·ã‚¹ãƒ†ãƒ ãƒ˜ãƒ«ã‚¹ãƒã‚§ãƒƒã‚¯
        `);
    </script>
</body>
</html>
